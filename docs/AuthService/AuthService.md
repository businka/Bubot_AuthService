#Auth Service
Сервис осуществляющий авутентификацию и авторизацию пользователей.

Сервис оперирует следующими понятиями:
* user - пользователь
* account - выделенный сегмент данных
* role - роль которая отведена пользователю 
* function - функции которые выполняет роль
* object - объект системы необходимый для выполнения функции
* form - форма предоставления данных объекта, позволяет ограничить доступ только к данным объекта которые есть на форме 
* level - уровень доступа к объекту необходимый для выполения функции
* limit - дополнительные ограничения в рамках объекта  

Уникальный идентификатор доступа к объекту 
* account / object + limit
Дополнительные огранияения доступа: применяется первое которое удовлетворяет по условию И 

route (для документов) + category + owner + formObj


## Действия
### check_right
Проверка полномочий, выполняется только для аутентифицированных пользователей

**Параметры**
* user (guid) - идентификатор пользователя
~~* device (guid) - идентификатор сервиса~~
* account (guid) - идентификатор аккаунта сервиса
* object (string) - идентификатор действия, обычно формируется по шаблону 
* level (int) - уровень доступа - 0 запрет, 10 просмотр, 20 изменение 30 полный  
* params (object) 

**Результат**

True/False -  в зависимости от наличия или отсутствия полномочий 

### auth_by_login
Аутентификация пользователя по логину паролю

**Параметры:**
* login (string)- параметры для аутентификации
* password (string) - идентификатор устройства

**Результат:**

идентификатор сессии в случае успеха 
  
  
#Объекты
##Справочник / Пользователь
* Имя
* Способы аутентификации
* Личность
* Права
* Роли

##Документ / СессияПользователя
* Пользователь
* Способ аутентификации
* Дата - начало сессии
* Конец
* Последняя активность

#Компоненты
* Аутентификация / Регистрация
* ~~Профиль~~
  * ~~Изменение реквизитов~~
  * ~~Подтверждение реквизитов~~
  * ~~Добавление способа аутентификации~~
  * ~~Объединение пользователей~~


## Аутентификация по логину паролю
Выполняется при помощи вызова одного метода [auth_by_login](#auth_by_login) с передачей логин и пароля. 
В ответ вы получаете идентификатор сессии который должен передаваться во всех последующих вызовах
в заголовке X-Session.
> После трех неудачных попыткок пользователь начитает временно блокироваться. 


## Права

* Приложение
  * Роли
    * Роли
    * Функции
  * Функции
    * Объекты - какие задействованы объекты, какаие свойства и методы.
      * Формы
      * Методы + Уровень доступа 
  * Объкты
    * Свойства
    * Методы
    * Формы
  



Система состоит из приложений.

Приложения нужны для выполнения определенных функций / сценариев. 

Функция для выполнения нужны данные.

Данные в приложении разбиты на объекты. У каждого объекта есть свойства, методы и набор форм для отображения.



Приложения хранят данные в аккаунтах - один аккаунт одна база данных. 
Пользоватеьль сам определяет какие приложения нужны в его аккаунте.

Пользователь может иметь доступ к нескольким приложенями и нескольким аккаунтам.

Одновременно в браузере одно приложение работает с одним аккаунтом. Данные об аккаунте с которым работает 
приложнние хранится в сессии пользователя. Если не установлено выбирается последний использованный или первый попавшийся

У каждого объекта есть три обязательныхх свойства
* _id - идентификатор
* title - представление объекта (может быть локализовано путем добавления копий с суфиксом локали)
* owner - ссылка на владельца

Ограничение доступа к объект реализовано следующим образом:

* У каждому методу объекта может быть определен уровень доступа пользователя - (Зона + уровень доступа) при наличии которого
доступно выполнение данного метода.
* Для каждого типа объекта пользователю может быть установлен доступ только объектами с определенным владельцем / списком владельцев.
* Для каждого типа объекта пользователю может быть установлен доступ только к определенным формам - будут выдавать свойства доступные на форме.

для облегчения администрирования наборы прав объединаются в роли и роли назначаются пользователю.
 


Приложение 

Уровни доступа:
* запрещен
* чтение
* изменение
* полный

* Роль
  * Приложение + Зона + Уровень доступа + Модификаторы

Модификаторы:
* Форма
* Владелец
  
У каждого метода объектта указано при каком уровне доступа он доступен